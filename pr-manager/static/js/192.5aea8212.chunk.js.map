{"version":3,"file":"static/js/192.5aea8212.chunk.js","mappings":"kNAEO,MAAMA,GAAiCC,E,QAAAA,IAAGC,IAAAA,GAAAC,EAAAA,EAAAA,GAAA,q7B,uBCS1C,MAAMC,EAAWA,KAEtB,MAAM,QAAEC,EAAO,OAAEC,IAAWC,EAAAA,EAAAA,YAAWC,EAAAA,KACjC,cAAEC,IAAkBF,EAAAA,EAAAA,YAAWG,EAAAA,KAE9BC,EAAcC,IAAmBC,EAAAA,EAAAA,WAAS,GAEjD,WACE,IACE,MAAMC,QAAiBC,EAAAA,EAAAA,KACvBC,QAAQC,IAAI,yBAA0BH,EACxC,CAAE,MAAOI,GACPF,QAAQC,IAAI,iCAAkCC,GAC1CC,OAAOD,GAAOE,WAAW,+BACN,IAAjBT,GACFC,GAAgB,GAGlBH,GAAc,EAElB,CACD,EAdD,GAgBA,MACEY,KAAMC,EAAe,MACrBJ,EAAK,QACLK,IACEC,EAAAA,EAAAA,GAASxB,EAAkB,CAC7ByB,UAAW,CACTpB,QAASA,EAAQqB,KAAKC,GAAWA,EAAOC,YAE1CC,YAAa,eACbC,gBAAiB,sBAEbT,GAAOU,EAAAA,EAAAA,UACX,IACiB,OAAfT,QAAe,IAAfA,OAAe,EAAfA,EAAiBU,MAAMC,MAAMC,QAAO,CAACC,EAAWC,KAC9CD,EAAIE,QAAQD,EAAKE,sBAAsBL,OAChCE,IACN,KACL,CAACb,IAGGiB,EAAQC,EAAAA,MAAW,IACvB,uCAAsBC,MAAMC,IAAM,CAChCC,QAASD,EAAOH,YAIpB,GAAI5B,EACF,OACEiC,EAAAA,EAAAA,KAACC,EAAAA,SAAQ,CAACC,UAAUF,EAAAA,EAAAA,KAACG,EAAAA,EAAO,CAACC,YAAY,KAAMC,UAC7CL,EAAAA,EAAAA,KAACL,EAAK,CACJW,aAAa,yEACb5C,OAAQA,MAMhB,GAAIiB,EACF,OAAOqB,EAAAA,EAAAA,KAACG,EAAAA,EAAO,CAACC,YAAY,iCAU9B,GANI9B,IACD2B,EAAAA,SAAoBE,EAAAA,EACE5B,OAAOD,SAInBiC,IAAT9B,EAEF,OADAZ,GAAc,GACP,KACF,CACL,MAAM2C,EAAUZ,EAAAA,MAAW,IACzB,6BAAoBC,MAAMC,IAAM,CAC9BC,QAASD,EAAOU,cAGpB,OACER,EAAAA,EAAAA,KAACC,EAAAA,SAAQ,CAACC,UAAUF,EAAAA,EAAAA,KAACG,EAAAA,EAAO,CAACC,YAAY,+BAAgCC,UACvEL,EAAAA,EAAAA,KAACQ,EAAO,CAAC/B,KAAMA,EAAMgC,QAASC,EAAAA,GAASC,YAG7C,E","sources":["utilities/prQueries/QUERY_GROUPS_PRS.ts","components/prTabs/tabs/GroupPRs.tsx"],"sourcesContent":["import { DocumentNode, gql } from \"@apollo/client\";\n\nexport const QUERY_GROUPS_PRS: DocumentNode = gql`\n  query AllMembersPRs($members: [String!]!) {\n    users(usernames: $members) {\n      nodes {\n        authoredMergeRequests(state: opened) {\n          nodes {\n            id\n            author {\n              username\n              name\n            }\n            title\n            webUrl\n            reviewers {\n              nodes {\n                username\n                name\n              }\n            }\n            labels {\n              nodes {\n                title\n              }\n            }\n            draft\n            conflicts\n            approvedBy {\n              nodes {\n                name\n                username\n              }\n            }\n            project {\n              fullPath\n            }\n            iid\n            autoMergeEnabled\n            approved\n            headPipeline {\n              status\n            }\n          }\n        }\n      }\n    }\n  }\n`;\n","import React, { useMemo, useContext, useState, Suspense } from \"react\";\nimport { useQuery } from \"@apollo/client\";\nimport { Loading } from \"../../Loading\";\nimport { validateGitLabToken } from \"../../../utilities/tokenValidationUtilities/validateGitLabToken\";\nimport {\n  MembersContext,\n  TokensInCacheContext,\n} from \"../../../contexts/Context\";\nimport { QUERY_GROUPS_PRS } from \"../../../utilities/prQueries/QUERY_GROUPS_PRS\";\nimport { MemberPR, PR, TAB_TYPE } from \"../../../utilities/constants\";\n\nexport const GroupPRs = () => {\n  // CHANGE THIS IN PROD\n  const { members, reload } = useContext(MembersContext);\n  const { setGitInCache } = useContext(TokensInCacheContext);\n\n  const [networkError, setNetworkError] = useState(false);\n\n  (async () => {\n    try {\n      const response = await validateGitLabToken();\n      console.log(\"GitLab PAT validated: \", response);\n    } catch (error) {\n      console.log(\"GitLab PAT validation failed: \", error);\n      if (String(error).startsWith(\"TypeError: Failed to fetch\")) {\n        if (networkError === false) {\n          setNetworkError(true);\n        }\n      } else {\n        setGitInCache(false);\n      }\n    }\n  })();\n\n  const {\n    data: unFlattenedData,\n    error,\n    loading,\n  } = useQuery(QUERY_GROUPS_PRS, {\n    variables: {\n      members: members.map((member) => member.username),\n    },\n    fetchPolicy: \"network-only\",\n    nextFetchPolicy: \"cache-and-network\",\n  });\n  const data = useMemo(\n    () =>\n      unFlattenedData?.users.nodes.reduce((acc: PR[], user: MemberPR) => {\n        acc.push(...user.authoredMergeRequests.nodes);\n        return acc;\n      }, []),\n    [unFlattenedData]\n  );\n\n  const Error = React.lazy(() =>\n    import(\"../../Error\").then((module) => ({\n      default: module.Error,\n    }))\n  );\n\n  if (networkError) {\n    return (\n      <Suspense fallback={<Loading loadingText=\"\" />}>\n        <Error\n          errorMessage=\"Failed to fetch: offline or your network doesn't have access to GitLab\"\n          reload={reload!}\n        />\n      </Suspense>\n    );\n  }\n\n  if (loading) {\n    return <Loading loadingText=\"Fetching PR's from GitLab...\" />;\n  }\n\n  // ADD ERROR SCREEN HERE\n  if (error) {\n    <Suspense fallback={<Loading loadingText=\"\" />}>\n      <Error errorMessage={String(error)} reload={reload} />\n    </Suspense>;\n  }\n\n  if (data === undefined) {\n    setGitInCache(false);\n    return null;\n  } else {\n    const AddData = React.lazy(() =>\n      import(\"./AddData\").then((module) => ({\n        default: module.AddData,\n      }))\n    );\n    return (\n      <Suspense fallback={<Loading loadingText=\"Loading Groupp PR's tab...\" />}>\n        <AddData data={data} tabType={TAB_TYPE.groupPRs} />\n      </Suspense>\n    );\n  }\n};\n"],"names":["QUERY_GROUPS_PRS","gql","_templateObject","_taggedTemplateLiteral","GroupPRs","members","reload","useContext","MembersContext","setGitInCache","TokensInCacheContext","networkError","setNetworkError","useState","response","validateGitLabToken","console","log","error","String","startsWith","data","unFlattenedData","loading","useQuery","variables","map","member","username","fetchPolicy","nextFetchPolicy","useMemo","users","nodes","reduce","acc","user","push","authoredMergeRequests","Error","React","then","module","default","_jsx","Suspense","fallback","Loading","loadingText","children","errorMessage","undefined","AddData","tabType","TAB_TYPE","groupPRs"],"sourceRoot":""}