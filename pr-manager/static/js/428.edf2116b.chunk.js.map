{"version":3,"file":"static/js/428.edf2116b.chunk.js","mappings":"kQAyDA,MACA,EAAe,IAA0B,wE,aCnDlC,MAAMA,EAA0BC,IAMhC,IANiC,oBACtCC,EAAmB,iBACnBC,GAIDF,EACC,MAAOG,EAASC,IAAcC,EAAAA,EAAAA,WAAkB,GAChD,OACEC,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CACJC,cAAc,SACdC,gBAAgB,SAChBC,uBAAqB,EACrBC,OAAQ,CAAEC,YAAa,SAAUC,SAAA,EAEjCC,EAAAA,EAAAA,KAACC,EAAAA,EAAK,CACJC,IAAI,iBACJC,IAAKC,EACLC,OAAQ,GACRC,MAAO,OAETd,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CACJC,cAAc,SACdC,gBAAgB,SAChBC,uBAAqB,EACrBC,OAAQ,CAAEC,YAAa,SAAUC,SAAA,EAEjCC,EAAAA,EAAAA,KAACO,EAAAA,EAAI,CAACC,KAAM,IAAIT,UACQ,IAArBX,EACG,4FACA,sCAENI,EAAAA,EAAAA,MAACC,EAAAA,EAAK,CACJgB,YAAU,EACVb,uBAAqB,EACrBC,OAAQ,CAAEC,YAAa,OACvBJ,cAAc,SAAQK,SAAA,EAEtBC,EAAAA,EAAAA,KAACU,EAAAA,EAAM,CACLC,SAAUtB,GAAWD,EACrBwB,WAAW,UACXC,QAASA,MC5CS,SAC5B1B,EACAG,GAEAA,GAAW,GACXwB,EAAAA,IAAmBC,aAAaC,MAAKC,UACnCH,EAAAA,eAA8BI,aAAa,CACzCC,IACEC,OAAOC,SAASC,QACfF,OAAOC,SAASE,SAASC,SAAS,sBAC/BJ,OAAOC,SAASE,SAASE,MAAM,GAAI,IACnCL,OAAOC,SAASE,SAASE,MAAM,GAAI,IACvC,6BACFnB,MAAO,IACPD,OAAQ,IACRqB,gBAAiB,SAAUC,GACzB,MAAM9B,EAMF+B,KAAKC,MAAMF,GACfG,aAAaC,SACXC,EAAAA,EAAAA,KACAnC,EAAOoC,eAET9C,GAAoB,GACpBG,GAAW,EACb,EACA4C,gBAAiB,SAAUC,GACzBC,QAAQC,IAAI,oCAAqCF,GACjDL,aAAaQ,YAAWN,EAAAA,EAAAA,MACxBF,aAAaQ,YAAWC,EAAAA,EAAAA,MACxBjD,GAAW,EACb,GACA,GAEN,CDOckD,CAAerD,EAAqBG,EAAW,EAC/CS,SACH,iBAGAX,IAAoBY,EAAAA,EAAAA,KAACyC,EAAAA,IAAwB,YAG5C,C","sources":["assets/atlassian-logo-blue.svg","components/acquireTokens/AtlassianAuthentication.tsx","utilities/tokenValidationUtilities/popupAtlassian.ts"],"sourcesContent":["var _path, _path2, _path3, _path4, _path5, _path6, _path7, _path8, _path9, _path10, _path11, _path12;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgAtlassianLogoBlue(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 195,\n    height: 32,\n    viewBox: \"0 0 195 32\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M121.21 17.9463C121.21 14.5433 119.384 12.9313 114.297 11.8209C111.467 11.2119 110.787 10.5672 110.787 9.67164C110.787 8.5612 111.79 8.0597 113.652 8.0597C115.909 8.0597 118.13 8.7403 120.243 9.70747V5.22985C118.775 4.47761 116.482 3.90448 113.796 3.90448C108.745 3.90448 106.13 6.08955 106.13 9.70747C106.13 12.5731 107.455 14.8657 112.685 15.8687C115.801 16.5134 116.446 17.0149 116.446 18.0537C116.446 19.0567 115.801 19.7015 113.581 19.7015C111.037 19.7015 107.993 18.8418 106.022 17.6597V22.3522C107.599 23.1403 109.676 24 113.545 24C119.061 24 121.21 21.5642 121.21 17.9463Z\",\n    fill: \"#0052CC\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M176.339 4.19104V23.7134H180.494V8.81194L182.249 12.7881L188.124 23.7134H193.354V4.19104H189.198V16.8L187.622 13.1463L182.894 4.19104H176.339Z\",\n    fill: \"#0052CC\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M149.903 4.19104H145.354V23.6776H149.903V4.19104Z\",\n    fill: \"#0052CC\"\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M140.124 17.9463C140.124 14.5433 138.297 12.9313 133.21 11.8209C130.381 11.2119 129.7 10.5672 129.7 9.67164C129.7 8.5612 130.703 8.0597 132.566 8.0597C134.822 8.0597 137.043 8.7403 139.157 9.70747V5.22985C137.688 4.47761 135.396 3.90448 132.709 3.90448C127.658 3.90448 125.043 6.08955 125.043 9.70747C125.043 12.5731 126.369 14.8657 131.598 15.8687C134.715 16.5134 135.36 17.0149 135.36 18.0537C135.36 19.0567 134.715 19.7015 132.494 19.7015C129.951 19.7015 126.906 18.8418 124.936 17.6597V22.3522C126.512 23.1403 128.59 24 132.458 24C137.975 24 140.124 21.5642 140.124 17.9463Z\",\n    fill: \"#0052CC\"\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M70.8821 4.19104V23.7134H80.2313L81.7 19.4866H75.4672V4.19104H70.8821Z\",\n    fill: \"#0052CC\"\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M52.4701 4.19104V8.41791H57.4851V23.7134H62.0701V8.41791H67.4791V4.19104H52.4701Z\",\n    fill: \"#0052CC\"\n  })), _path7 || (_path7 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M45.8433 4.19104H39.8612L33.0552 23.6776H38.2493L39.2164 20.3821C40.3627 20.7045 41.5806 20.9194 42.8701 20.9194C44.1239 20.9194 45.3418 20.7403 46.5239 20.3821L47.491 23.6776H52.6851L45.8433 4.19104ZM42.8343 16.9075C41.9746 16.9075 41.1149 16.7642 40.3269 16.5492L42.8343 8.02388L45.3418 16.5492C44.5537 16.7642 43.694 16.9075 42.8343 16.9075Z\",\n    fill: \"#0052CC\"\n  })), _path8 || (_path8 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M96.3149 4.19104H90.3328L83.5269 23.6776H88.7209L89.6881 20.3821C90.8343 20.7045 92.0522 20.9194 93.3418 20.9194C94.5955 20.9194 95.8134 20.7403 96.9955 20.3821L97.9627 23.6776H103.157L96.3149 4.19104ZM93.3418 16.9075C92.4821 16.9075 91.6224 16.7642 90.8343 16.5492L93.3418 8.02388L95.8493 16.5492C95.0254 16.7642 94.2015 16.9075 93.3418 16.9075Z\",\n    fill: \"#0052CC\"\n  })), _path9 || (_path9 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M166.273 4.19104H160.291L153.485 23.6776H158.679L159.646 20.3821C160.793 20.7045 162.01 20.9194 163.3 20.9194C164.554 20.9194 165.772 20.7403 166.954 20.3821L167.921 23.6776H173.115L166.273 4.19104ZM163.264 16.9075C162.404 16.9075 161.545 16.7642 160.757 16.5492L163.264 8.02388L165.772 16.5492C164.984 16.7642 164.16 16.9075 163.264 16.9075Z\",\n    fill: \"#0052CC\"\n  })), _path10 || (_path10 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M140.124 17.9463C140.124 14.5433 138.333 12.9313 133.21 11.8209C130.381 11.2119 129.7 10.5672 129.7 9.67163C129.7 8.56119 130.703 8.05969 132.566 8.05969C134.822 8.05969 137.043 8.74029 139.157 9.70745V5.22984C137.151 4.2985 134.93 3.86865 132.709 3.90447C127.658 3.90447 125.043 6.08954 125.043 9.70745C125.043 12.5731 126.369 14.8657 131.598 15.8686C134.715 16.5134 135.36 17.0149 135.36 18.0537C135.36 19.0925 134.715 19.7015 132.494 19.7015C129.843 19.6657 127.228 18.9492 124.936 17.6597V22.3522C126.512 23.1403 128.59 24 132.458 24C137.939 24 140.088 21.5642 140.124 17.9463Z\",\n    fill: \"#0052CC\"\n  })), _path11 || (_path11 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M6.83433 11.0687C6.72686 10.9254 6.51194 10.8537 6.33283 10.8537C6.18955 10.8896 6.04627 10.997 5.97462 11.1403L0.0641768 22.9612C-0.0791068 23.2119 0.0283559 23.5343 0.279102 23.6418C0.350744 23.6776 0.422386 23.7134 0.494028 23.7134H8.73283C8.91194 23.7134 9.12686 23.606 9.19851 23.4269C10.9537 19.8448 9.8791 14.2925 6.83433 11.0687Z\",\n    fill: \"#0052CC\"\n  })), _path12 || (_path12 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M23.706 22.9612C23.5627 22.7463 12.6373 0.823881 12.3507 0.286567C12.2791 0.107463 12.1358 0 11.9567 0H11.9209C11.7418 0 11.5627 0.107463 11.4552 0.286567C8.48209 4.9791 8.1597 10.6746 10.5597 15.4746L14.5358 23.391C14.6075 23.5702 14.7866 23.6776 15.0015 23.6776H23.2403C23.5269 23.6776 23.7418 23.4627 23.7418 23.1761C23.7418 23.1045 23.7418 23.0328 23.706 22.9612Z\",\n    fill: \"#0052CC\"\n  })));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgAtlassianLogoBlue);\nexport default __webpack_public_path__ + \"static/media/atlassian-logo-blue.d7db2ff89c7746840661a29a32f36a60.svg\";\nexport { ForwardRef as ReactComponent };","import { useState } from \"react\";\nimport { popupAtlassian } from \"../../utilities/tokenValidationUtilities/popupAtlassian\";\nimport { Button, Text, Image } from \"@fluentui/react-components\";\nimport { Stack } from \"@fluentui/react\";\nimport { CheckmarkCircle24Regular } from \"@fluentui/react-icons\";\nimport atlassianLogoBlue from \"../../assets/atlassian-logo-blue.svg\";\n\nexport const AtlassianAuthentication = ({\n  setAtlassianInCache,\n  atlassianInCache,\n}: {\n  setAtlassianInCache: React.Dispatch<React.SetStateAction<boolean>>;\n  atlassianInCache: boolean;\n}) => {\n  const [loading, setLoading] = useState<boolean>(false);\n  return (\n    <Stack\n      verticalAlign=\"center\"\n      horizontalAlign=\"center\"\n      enableScopedSelectors\n      tokens={{ childrenGap: \"1.8em\" }}\n    >\n      <Image\n        alt=\"Atlassian logo\"\n        src={atlassianLogoBlue}\n        height={60}\n        width={350}\n      />\n      <Stack\n        verticalAlign=\"center\"\n        horizontalAlign=\"center\"\n        enableScopedSelectors\n        tokens={{ childrenGap: \"1.5em\" }}\n      >\n        <Text size={400}>\n          {atlassianInCache === false\n            ? \"In order to fetch data from Jira we need you to do authentication by pressing the button:\"\n            : \"Atlassian account authenticated!\"}\n        </Text>\n        <Stack\n          horizontal\n          enableScopedSelectors\n          tokens={{ childrenGap: \"1em\" }}\n          verticalAlign=\"center\"\n        >\n          <Button\n            disabled={loading || atlassianInCache}\n            appearance=\"primary\"\n            onClick={() => {\n              popupAtlassian(setAtlassianInCache, setLoading);\n            }}\n          >\n            Authenticate\n          </Button>\n          {atlassianInCache && <CheckmarkCircle24Regular />}\n        </Stack>\n      </Stack>\n    </Stack>\n  );\n};\n","import { getAtlassianRefreshTokenKey } from \"./getters/getAtlassianRefreshTokenKey\";\nimport { getAtlassianAccessTokenKey } from \"./getters/getAtlassianAcessTokenKey\";\nimport * as microsoftTeams from \"@microsoft/teams-js\";\n\nexport const popupAtlassian = function (\n  setAtlassianInCache: React.Dispatch<React.SetStateAction<boolean>>,\n  setLoading: React.Dispatch<React.SetStateAction<boolean>>\n): void {\n  setLoading(true);\n  microsoftTeams.app.initialize().then(async () => {\n    microsoftTeams.authentication.authenticate({\n      url:\n        window.location.origin +\n        (window.location.pathname.includes(\"configuration.html\")\n          ? window.location.pathname.slice(0, -21)\n          : window.location.pathname.slice(0, -1)) +\n        \"/atlassian-auth-start.html\",\n      width: 600,\n      height: 900,\n      successCallback: function (result: string): void {\n        const tokens: {\n          access_token: string;\n          refresh_token: string;\n          expires_in: number;\n          scope: string;\n          token_type: string;\n        } = JSON.parse(result);\n        localStorage.setItem(\n          getAtlassianRefreshTokenKey(),\n          tokens.refresh_token\n        );\n        setAtlassianInCache(true);\n        setLoading(false);\n      },\n      failureCallback: function (reason: string): void {\n        console.log(\"Atlassian authentication failed: \", reason);\n        localStorage.removeItem(getAtlassianRefreshTokenKey());\n        localStorage.removeItem(getAtlassianAccessTokenKey());\n        setLoading(false);\n      },\n    });\n  });\n};\n"],"names":["AtlassianAuthentication","_ref","setAtlassianInCache","atlassianInCache","loading","setLoading","useState","_jsxs","Stack","verticalAlign","horizontalAlign","enableScopedSelectors","tokens","childrenGap","children","_jsx","Image","alt","src","atlassianLogoBlue","height","width","Text","size","horizontal","Button","disabled","appearance","onClick","microsoftTeams","initialize","then","async","authenticate","url","window","location","origin","pathname","includes","slice","successCallback","result","JSON","parse","localStorage","setItem","getAtlassianRefreshTokenKey","refresh_token","failureCallback","reason","console","log","removeItem","getAtlassianAccessTokenKey","popupAtlassian","CheckmarkCircle24Regular"],"sourceRoot":""}